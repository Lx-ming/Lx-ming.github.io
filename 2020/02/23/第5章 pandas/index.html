<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>第5章 pandas | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="pandas专门为处理表格和混杂数据设计,numpy更适合处理统一的数值数组数据  5.1 pandas的数据结构介绍5.1.1 series12345678910111213141516171819202122obj &#x3D; pd.Series([4, 7, -5, 3]) -- #包含索引的对象obj.valuesobj.indexobj2 &#x3D; pd.Series([4, 7, -5, 3],">
<meta property="og:type" content="article">
<meta property="og:title" content="第5章 pandas">
<meta property="og:url" content="http://yoursite.com/2020/02/23/%E7%AC%AC5%E7%AB%A0%20pandas/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="pandas专门为处理表格和混杂数据设计,numpy更适合处理统一的数值数组数据  5.1 pandas的数据结构介绍5.1.1 series12345678910111213141516171819202122obj &#x3D; pd.Series([4, 7, -5, 3]) -- #包含索引的对象obj.valuesobj.indexobj2 &#x3D; pd.Series([4, 7, -5, 3],">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-02-23T06:53:46.000Z">
<meta property="article:modified_time" content="2020-03-01T04:53:03.000Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-第5章 pandas" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/23/%E7%AC%AC5%E7%AB%A0%20pandas/" class="article-date">
  <time datetime="2020-02-23T06:53:46.000Z" itemprop="datePublished">2020-02-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      第5章 pandas
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>pandas专门为处理表格和混杂数据设计,numpy更适合处理统一的数值数组数据</li>
</ol>
<h2 id="5-1-pandas的数据结构介绍"><a href="#5-1-pandas的数据结构介绍" class="headerlink" title="5.1 pandas的数据结构介绍"></a>5.1 pandas的数据结构介绍</h2><h3 id="5-1-1-series"><a href="#5-1-1-series" class="headerlink" title="5.1.1 series"></a>5.1.1 series</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">obj = pd.Series([<span class="number">4</span>, <span class="number">7</span>, <span class="number">-5</span>, <span class="number">3</span>]) -- <span class="comment">#包含索引的对象</span></span><br><span class="line"></span><br><span class="line">obj.values</span><br><span class="line">obj.index</span><br><span class="line">obj2 = pd.Series([<span class="number">4</span>, <span class="number">7</span>, <span class="number">-5</span>, <span class="number">3</span>], index=[<span class="string">'d'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>])</span><br><span class="line">obj2[<span class="string">'a'</span>]</span><br><span class="line">obj2[[<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>]]</span><br><span class="line">obj2[obj2 &gt; <span class="number">0</span>]</span><br><span class="line">obj2 * <span class="number">2</span></span><br><span class="line"><span class="string">'b'</span> <span class="keyword">in</span> obj2</span><br><span class="line"></span><br><span class="line">obj3 = pd.Series(sdata) -- <span class="comment">#字典转化series</span></span><br><span class="line">obj4 = pd.Series(sdata, index=states) --<span class="comment">#按照states的键排列sdata的值</span></span><br><span class="line"></span><br><span class="line">pd.isnull(obj4) / pd.notnull(obj4) / obj4.isnull()</span><br><span class="line"></span><br><span class="line">obj3 + obj4 -- <span class="comment">#自动对齐键类似join操作</span></span><br><span class="line"></span><br><span class="line">obj4.name = <span class="string">'population'</span></span><br><span class="line">obj4.index.name = <span class="string">'state'</span> </span><br><span class="line"></span><br><span class="line">obj.index = [<span class="string">'Bob'</span>, <span class="string">'Steve'</span>, <span class="string">'Jeff'</span>, <span class="string">'Ryan'</span>]</span><br></pre></td></tr></table></figure>

<h3 id="5-1-2-DataFrame"><a href="#5-1-2-DataFrame" class="headerlink" title="5.1.2 DataFrame"></a>5.1.2 DataFrame</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">表格型数据结构 -- <span class="comment">#可以看做由series组成的字典(共用同一个索引)</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">pd.dataframe(data,columns=[],index=[]);</span></span><br><span class="line"><span class="string">pd.dataframe(&#123;dic&#123;dic&#125;&#125;)</span></span><br><span class="line"><span class="string">head()</span></span><br><span class="line"><span class="string">.T</span></span><br><span class="line"><span class="string">.value</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(data) -- <span class="comment">#data是由等长列表或numpy数组组成的字典</span></span><br><span class="line">frame.head() -- <span class="comment">#选取前五行</span></span><br><span class="line">pd.DataFrame(data, columns=[<span class="string">'year'</span>, <span class="string">'state'</span>, <span class="string">'pop'</span>]) -- <span class="comment">#指定列标签,如果传入标签不在原数据中 则产生NAN</span></span><br><span class="line">frame2 = pd.DataFrame(data, columns=[<span class="string">'year'</span>, <span class="string">'state'</span>, <span class="string">'pop'</span>, <span class="string">'debt'</span>],</span><br><span class="line">		index=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>,<span class="string">'five'</span>, <span class="string">'six'</span>]) --<span class="comment">#指定列标签与行标签</span></span><br><span class="line">frame2.columns</span><br><span class="line"></span><br><span class="line">frame2[<span class="string">'state'</span>] / frame2.year -- <span class="comment">#获取state列的series,第二种方法只有在列标签是合理的python变量时才行</span></span><br><span class="line">frame2.loc[<span class="string">'three'</span>] --<span class="comment">#返回three标签（无论行还是列）的series</span></span><br><span class="line">frame2[<span class="string">'debt'</span>] = <span class="number">16.5</span> / frame2[<span class="string">'debt'</span>] = np.arange(<span class="number">6.</span>)</span><br><span class="line"></span><br><span class="line">frame2[<span class="string">'eastern'</span>] = frame2.state == <span class="string">'Ohio'</span></span><br><span class="line"><span class="keyword">del</span> frame2[<span class="string">'eastern'</span>]</span><br><span class="line"><span class="comment">#索引方式产生的都是视图 不会创建副本</span></span><br><span class="line"></span><br><span class="line">frame3 = pd.DataFrame(pop) -- <span class="comment">#嵌套字典外层键作为列标签,内层键作为行标签</span></span><br><span class="line">frame3.T</span><br><span class="line">pd.DataFrame(pop, index=[<span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>]) -- 排序</span><br><span class="line">frame3.index.name = <span class="string">'year'</span>; frame3.columns.name = <span class="string">'state'</span> -- <span class="comment">#行标签\列标签名</span></span><br><span class="line"></span><br><span class="line">frame3.values -- <span class="comment">#返回二维数组</span></span><br></pre></td></tr></table></figure>

<h3 id="5-1-3-索引对象"><a href="#5-1-3-索引对象" class="headerlink" title="5.1.3 索引对象"></a>5.1.3 索引对象</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#index</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string"> obj.index</span></span><br><span class="line"><span class="string"> pd.Series([1.5, -2.5, 0], index=labels)</span></span><br><span class="line"><span class="string"> .columns</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">index = obj.index</span><br><span class="line">index[<span class="number">1</span>:] -- </span><br><span class="line">obj2 = pd.Series([<span class="number">1.5</span>, <span class="number">-2.5</span>, <span class="number">0</span>], index=labels)</span><br><span class="line">index对象不可修改</span><br><span class="line">frame3.columns -- <span class="comment">#返回列标签的index对象</span></span><br><span class="line"></span><br><span class="line">index.append(A) -- <span class="comment">#链接</span></span><br><span class="line">difference  -- <span class="comment">#差集</span></span><br><span class="line">intersection -- <span class="comment">#交集</span></span><br><span class="line">union -- <span class="comment">#并集</span></span><br><span class="line">isin --</span><br></pre></td></tr></table></figure>



<h2 id="5-2-基本功能"><a href="#5-2-基本功能" class="headerlink" title="5.2 基本功能"></a>5.2 基本功能</h2><h3 id="5-2-1重新索引"><a href="#5-2-1重新索引" class="headerlink" title="5.2.1重新索引"></a>5.2.1重新索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#reindex</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string"> obj.reindex([],method='ffill')</span></span><br><span class="line"><span class="string"> .reindex([])</span></span><br><span class="line"><span class="string"> .reindex(columns=[])</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">obj2 = obj.reindex([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>])</span><br><span class="line">obj3.reindex(range(<span class="number">6</span>), method=<span class="string">'ffill'</span>) -- <span class="comment">#向前值填充</span></span><br><span class="line"></span><br><span class="line">frame = pd.DataFrame(np.arange(<span class="number">9</span>).reshape((<span class="number">3</span>, <span class="number">3</span>)),</span><br><span class="line">                      index=[<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>],</span><br><span class="line">                      columns=[<span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'California'</span>])</span><br><span class="line">frame2 = frame.reindex([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]) -- <span class="comment">#没有b行情况下,reindex中的b行的值显示nan</span></span><br><span class="line">frame.reindex(columns=states) -- <span class="comment">#更改列标签</span></span><br><span class="line"></span><br><span class="line">reindex函数的参数:</span><br><span class="line">index -- <span class="comment">#用作索引的新实例</span></span><br><span class="line">method -- <span class="comment">#插值填充方式</span></span><br><span class="line">fill_value <span class="comment">#需要引缺失值时使用的替代值</span></span><br><span class="line">limit -- <span class="comment">#前向或后向填充时的最大填充量</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-2-丢弃指定轴上的项"><a href="#5-2-2-丢弃指定轴上的项" class="headerlink" title="5.2.2 丢弃指定轴上的项"></a>5.2.2 丢弃指定轴上的项</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#drop</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">obj.drop('',axis=1,inplace=true)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">new_obj = obj.drop(<span class="string">'c'</span>)</span><br><span class="line">obj.drop([<span class="string">'d'</span>, <span class="string">'c'</span>]) -- <span class="comment">#删除行标签的值</span></span><br><span class="line">data.drop(<span class="string">'two'</span>, axis=<span class="number">1</span>) / data.drop([<span class="string">'two'</span>, <span class="string">'four'</span>], axis=<span class="string">'columns'</span>)-- <span class="comment">#删除列标签的值</span></span><br><span class="line">obj.drop(<span class="string">'c'</span>, inplace=<span class="literal">True</span>) -- <span class="comment">#就地修改对象 不会创建副本</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-3-索引-选取和过滤"><a href="#5-2-3-索引-选取和过滤" class="headerlink" title="5.2.3 索引\选取和过滤"></a>5.2.3 索引\选取和过滤</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#series:</span></span><br><span class="line">obj[<span class="string">'b'</span>] -- <span class="comment">#行标签索引 b行的值 返回值</span></span><br><span class="line">obj[<span class="number">1</span>] -- <span class="comment">#第一行的值 返回值</span></span><br><span class="line">obj[[<span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>]] -- <span class="comment">#第 b/a/d行的series</span></span><br><span class="line">obj[[<span class="number">1</span>, <span class="number">3</span>]] -- <span class="comment">#第1/4行的series</span></span><br><span class="line">obj[obj &lt; <span class="number">2</span>] -- <span class="comment">#返回值小于2的series</span></span><br><span class="line">obj[<span class="string">'b'</span>:<span class="string">'c'</span>] -- <span class="comment">#切片包含末端 与python切片运算不同</span></span><br><span class="line">obj[<span class="string">'b'</span>:<span class="string">'c'</span>] = <span class="number">5</span> -- <span class="comment">#b行到c行值改为5 返回series</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#dataframe:</span></span><br><span class="line">data[<span class="string">'two'</span>] -- <span class="comment">#列标签索引返回series</span></span><br><span class="line">data[[<span class="string">'three'</span>, <span class="string">'one'</span>]] -- <span class="comment">#列标签索引返回dataframe</span></span><br><span class="line">data[:<span class="number">2</span>] -- <span class="comment">#行标签索引,不包含末端返回dataframe</span></span><br><span class="line">data[data[<span class="string">'three'</span>] &gt; <span class="number">5</span>] -- <span class="comment">#three列的值大于5的dataframe</span></span><br><span class="line">data &lt; <span class="number">5</span> -- <span class="comment">#返回值小于五的布尔型dataframe</span></span><br><span class="line"><span class="comment">#单一的列表或元素时候就是选择列,否则选择行</span></span><br></pre></td></tr></table></figure>



<h3 id="5-2-4-用loc和iloc进行选取"><a href="#5-2-4-用loc和iloc进行选取" class="headerlink" title="5.2.4 用loc和iloc进行选取"></a>5.2.4 用loc和iloc进行选取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">loc -- <span class="comment">#轴标签索引</span></span><br><span class="line">iloc -- <span class="comment">#整数索引</span></span><br><span class="line"><span class="comment">#如果轴索引含有整数，数据选取总会使用标签</span></span><br><span class="line"><span class="comment">#为了更准确 最好使用loc、iloc索引</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.loc(['',['','']])</span></span><br><span class="line"><span class="string">.loc([:'',''])</span></span><br><span class="line"><span class="string">.iloc同上</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">data.loc[<span class="string">'Colorado'</span>, [<span class="string">'two'</span>, <span class="string">'three'</span>]] -- <span class="comment">#返回colorado行,two和three列的series</span></span><br><span class="line">data.iloc[<span class="number">2</span>, [<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]] -- <span class="comment">#返回第2行,第3\0\1列的series</span></span><br><span class="line">data.iloc[<span class="number">2</span>] -- <span class="comment">#返回地2行的series</span></span><br><span class="line">data.iloc[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]] -- <span class="comment">#返回1\2行,3\0\1列的datafram</span></span><br><span class="line">data.loc[:<span class="string">'Utah'</span>, <span class="string">'two'</span>] -- <span class="comment">#到utah行,TWO列的series</span></span><br><span class="line">data.iloc[:, :<span class="number">3</span>][data.three &gt; <span class="number">5</span>] -- <span class="comment">#所有行+到前3列的dataframe里three列的值大于5的dataframe</span></span><br></pre></td></tr></table></figure>



<h3 id="5-2-7-并集"><a href="#5-2-7-并集" class="headerlink" title="5.2.7 并集"></a>5.2.7 并集</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对于series 会自动对齐行标签 -- #标签相加，值取并集</span></span><br><span class="line"><span class="comment">#对于dataframe 会自动对齐行和列标签 -- #标签相加，值取并集（公共部分）</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">+,-</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>



<h3 id="5-2-7-在算数方法中填充值"><a href="#5-2-7-在算数方法中填充值" class="headerlink" title="5.2.7 在算数方法中填充值"></a>5.2.7 在算数方法中填充值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">np.nan</span></span><br><span class="line"><span class="string">.add(df,fill_value=)</span></span><br><span class="line"><span class="string">.rdiv</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">df1 = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line">                    columns=list(<span class="string">'abcd'</span>))</span><br><span class="line">df2.loc[<span class="number">1</span>, <span class="string">'b'</span>] = np.nan</span><br><span class="line">df1.add(df2, fill_value=<span class="number">0</span>) -- <span class="comment">#nan值填充为0</span></span><br><span class="line"><span class="number">1</span> / df1； df1.rdiv(<span class="number">1</span>) -- <span class="comment">#被1除</span></span><br><span class="line"></span><br><span class="line">add，radd -- <span class="comment">#加法+</span></span><br><span class="line">sub，rsub -- <span class="comment">#减法-</span></span><br><span class="line">div，rdiv -- <span class="comment">#除法/</span></span><br><span class="line">floordiv，rfloordiv -- <span class="comment">#底除//</span></span><br><span class="line">mul，rmul -- <span class="comment">#乘法*</span></span><br><span class="line">pow，rpow -- <span class="comment">#指数**</span></span><br><span class="line"></span><br><span class="line">df1.reindex(columns=df2.columns, fill_value=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>



<h3 id="5-2-8-DataFrame和Series之间的运算"><a href="#5-2-8-DataFrame和Series之间的运算" class="headerlink" title="5.2.8 DataFrame和Series之间的运算"></a>5.2.8 DataFrame和Series之间的运算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">arr1-arr[] --数组操作</span></span><br><span class="line"><span class="string">df-series </span></span><br><span class="line"><span class="string">df+series</span></span><br><span class="line"><span class="string">df.sub(series,axis='index')</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">arr - arr[<span class="number">0</span>] --<span class="comment">#每一行都会减去arr[0] arr是数组</span></span><br><span class="line">df - series</span><br><span class="line"><span class="comment">#默认下DataFrame和Series之间的算术运算会将Series的索引匹配到DataFrame的列，然后沿着行一直向下广播</span></span><br><span class="line">如果某个索引值在DataFrame的列或Series的索引中找不到--<span class="comment">#所有列标签相加,df每一行值加series</span></span><br><span class="line"></span><br><span class="line">frame.sub(series3, axis=<span class="string">'index'</span>) -- <span class="comment">#在列上广播</span></span><br></pre></td></tr></table></figure>



<h3 id="5-2-9-函数应用和映射"><a href="#5-2-9-函数应用和映射" class="headerlink" title="5.2.9 函数应用和映射"></a>5.2.9 函数应用和映射</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">np.abs(df)</span></span><br><span class="line"><span class="string">df.apply(f,axis='cloumns')</span></span><br><span class="line"><span class="string">df.applymap(format)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">np.abs(frame) -- <span class="comment">#取绝对值</span></span><br><span class="line">f = <span class="keyword">lambda</span> x: x.max() - x.min() -- frame.apply(f) --<span class="comment">#每一列的最大值减最小值</span></span><br><span class="line">frame.apply(f, axis=<span class="string">'columns'</span>) -- <span class="comment">#每行的最大值减去\最小值</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line">     <span class="keyword">return</span> pd.Series([x.min(), x.max()], index=[<span class="string">'min'</span>, <span class="string">'max'</span>])</span><br><span class="line">frame.apply(f) --<span class="comment">#返回每列最大值和最小值的dataframe</span></span><br><span class="line"></span><br><span class="line">format = <span class="keyword">lambda</span> x: <span class="string">'%.2f'</span> % x</span><br><span class="line">frame.applymap(format) -- <span class="comment">#得到frame中各个浮点值的格式化字符串</span></span><br><span class="line">frame[<span class="string">'e'</span>].map(format) -- <span class="comment">#e列的浮点值的字符串 series</span></span><br></pre></td></tr></table></figure>



<h3 id="5-2-10-排序和排名"><a href="#5-2-10-排序和排名" class="headerlink" title="5.2.10 排序和排名"></a>5.2.10 排序和排名</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.sort_index()</span></span><br><span class="line"><span class="string">.sort_index(axis=1,ascending=False)</span></span><br><span class="line"><span class="string">.sort_values()</span></span><br><span class="line"><span class="string">frame.sort_values(by='b') </span></span><br><span class="line"><span class="string">.rank()</span></span><br><span class="line"><span class="string">.rank(method='first')</span></span><br><span class="line"><span class="string">.rank(ascending=False, method='max')</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment">#按标签排序</span></span><br><span class="line">obj.sort_index() -- <span class="comment">#series行标签按照升序排序</span></span><br><span class="line">frame.sort_index() -- <span class="comment">#datframe行标签升序排序</span></span><br><span class="line">frame.sort_index(axis=<span class="number">1</span>) -- <span class="comment">#列标签按照升序排列</span></span><br><span class="line">frame.sort_index(axis=<span class="number">1</span>, ascending=<span class="literal">False</span>) --<span class="comment">#降序排列</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#按值排序</span></span><br><span class="line">obj.sort_values() --<span class="comment">#按series的值排序(缺失值被放到末尾)</span></span><br><span class="line">frame.sort_values(by=<span class="string">'b'</span>) -- <span class="comment">#按dataframe b列的值升序</span></span><br><span class="line">frame.sort_values(by=[<span class="string">'a'</span>, <span class="string">'b'</span>]) -- <span class="comment">#按a列和b列排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#rank方法</span></span><br><span class="line">obj.rank() -- <span class="comment">#返回series中每个值的平均排名 相等的值排名都等于平均值</span></span><br><span class="line">obj.rank(method=<span class="string">'first'</span>) -- <span class="comment">#按照原数据的顺序给出排名 相等的值第一个出现的排名在前</span></span><br><span class="line">obj.rank(ascending=<span class="literal">False</span>, method=<span class="string">'max'</span>) -- <span class="comment">#降序排列,max--相等的值取其最大的排名</span></span><br></pre></td></tr></table></figure>



<h3 id="5-2-11-带有重复标签的轴索引"><a href="#5-2-11-带有重复标签的轴索引" class="headerlink" title="5.2.11 带有重复标签的轴索引"></a>5.2.11 带有重复标签的轴索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj.index.is_unique -- <span class="comment">#判断标签是否唯一</span></span><br><span class="line">obj[<span class="string">'a'</span>] -- <span class="comment">#如果标签不唯一,则返回series/dataframe</span></span><br></pre></td></tr></table></figure>



<h2 id="5-3-汇总和计算描述统计"><a href="#5-3-汇总和计算描述统计" class="headerlink" title="5.3 汇总和计算描述统计"></a>5.3 汇总和计算描述统计</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">df.sum() -- <span class="comment">#行标签的值相加</span></span><br><span class="line">df.sum(axis=<span class="number">1</span>) -- <span class="comment">#列标签相加</span></span><br><span class="line">df.mean(axis=<span class="string">'columns'</span>, skipna=<span class="literal">False</span>) -- <span class="comment">#不要跳过NA值-凡是NA值的都为NA</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#约简方法选项</span></span><br><span class="line">axis -- <span class="comment">#约简的轴</span></span><br><span class="line">skipna -- <span class="comment">#排除缺失值,默认为True</span></span><br><span class="line">level -- <span class="comment">#根据level分组约简</span></span><br><span class="line"></span><br><span class="line">df.idxmax() / df.idxmin() -- <span class="comment">#返回每列最大值的行标签名</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#累计型</span></span><br><span class="line">df.cumsum() -- <span class="comment">#每一行累加上面的行</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#其他类型</span></span><br><span class="line">df.describe() -- <span class="comment">#返回每列的包括计数\均值\最小值等数据 dataframe</span></span><br><span class="line">obj.describe() -- <span class="comment">#返回series的统计结果</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#描述和汇总统计</span></span><br><span class="line">count --<span class="comment">#非na值的数量</span></span><br><span class="line">descrinle --<span class="comment">#针对列计算的汇总统计</span></span><br><span class="line">argmin\argmax --<span class="comment">#最小值和最大值的索引位置(整数)</span></span><br><span class="line">idxmax\idxmin --<span class="comment">#最小值和最大值的索引值</span></span><br><span class="line">quantile --<span class="comment">#计算样本分位数</span></span><br><span class="line">sum --<span class="comment">#值的总和</span></span><br><span class="line">mean --<span class="comment">#平均值</span></span><br><span class="line">median --<span class="comment">#算数中位数(50%分位数)</span></span><br><span class="line">mad --<span class="comment">#根据平均值计算平均绝对离差</span></span><br><span class="line">var --<span class="comment">#样本值的方差</span></span><br><span class="line">std --<span class="comment">#样本值的标准差</span></span><br><span class="line">skew --<span class="comment">#样本值的偏度(三阶矩)</span></span><br><span class="line">kurt --<span class="comment">#样本值的峰度(四阶矩)</span></span><br><span class="line">cumsum --<span class="comment">#样本值的累计和</span></span><br><span class="line">cummin\cummax --<span class="comment">#样本值的累计最大值和累计最小值</span></span><br><span class="line">cumprod --<span class="comment">#样本值的累计积</span></span><br><span class="line">diff --<span class="comment">#计算一阶差分</span></span><br><span class="line">pct_change --<span class="comment">#计算百分数变化</span></span><br></pre></td></tr></table></figure>



<h3 id="5-3-1-相关系数与协方差"><a href="#5-3-1-相关系数与协方差" class="headerlink" title="5.3.1 相关系数与协方差"></a>5.3.1 相关系数与协方差</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">conda install pandas-datareader --<span class="comment">#datareader包用于下载数据</span></span><br><span class="line"><span class="keyword">import</span> pandas_datareader.data <span class="keyword">as</span> web</span><br><span class="line"></span><br><span class="line">returns = price.pct_change() -- <span class="comment">#百分比变化</span></span><br><span class="line">returns.tail() -- <span class="comment">#显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#两个series间的运算</span></span><br><span class="line">returns[<span class="string">'MSFT'</span>].corr(returns[<span class="string">'IBM'</span>]) -- <span class="comment">#corr用于计算两个series中重叠的按索引对齐的值的相关系数</span></span><br><span class="line">returns[<span class="string">'MSFT'</span>].cov(returns[<span class="string">'IBM'</span>]) -- <span class="comment">#cov用于计算协方差</span></span><br><span class="line"></span><br><span class="line">returns.corr()/returns.cov() -- <span class="comment">#返回完整的相关系数或协方差</span></span><br><span class="line">returns.corrwith(returns.IBM) -- <span class="comment">#计算列或行与另一个series或dataframe之间的相关系数</span></span><br></pre></td></tr></table></figure>



<h3 id="5-3-2-唯一值-值计数以及成员资格"><a href="#5-3-2-唯一值-值计数以及成员资格" class="headerlink" title="5.3.2 唯一值\值计数以及成员资格"></a>5.3.2 唯一值\值计数以及成员资格</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">obj.unique() -- <span class="comment">#返回series中的唯一值数组</span></span><br><span class="line">obj.value_counts() -- <span class="comment">#计算series中各值出现的频率,按照值的降序排列</span></span><br><span class="line">pd.value_counts(obj.values, sort=<span class="literal">False</span>) -- <span class="comment">#计算series中各值出现的频率,按照序列名排序</span></span><br><span class="line">mask = obj.isin([<span class="string">'b'</span>, <span class="string">'c'</span>]) -- <span class="comment">#返回布尔型数组</span></span><br><span class="line">obj[mask] -- <span class="comment">#显示bc所在的series</span></span><br><span class="line">pd.Index(unique_vals).get_indexer(to_match) -- <span class="comment">#显示后一series的值 在前一个series中的序列 返回数组</span></span><br><span class="line">data.apply(pd.value_counts).fillna(<span class="number">0</span>) -- <span class="comment">#所有的值在各列所出现的频率</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/02/23/%E7%AC%AC5%E7%AB%A0%20pandas/" data-id="ckaeq4jtx0002xb6007v18pey" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/05/20/hello-world/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Hello World
        
      </div>
    </a>
  
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/20/test-1/">test_1</a>
          </li>
        
          <li>
            <a href="/2020/05/20/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2020/02/23/%E7%AC%AC5%E7%AB%A0%20pandas/">第5章 pandas</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>